/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package M09.UF1.Act6;

import static M09.UF1.Act5.Act5.randomGenerate;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.PrintStream;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.spec.X509EncodedKeySpec;
import java.util.Scanner;

/**
 *
 * @author Marc
 */
public class Generacio {
 
    
    String clauPri, clauPu;
    
    
    public static void main(String args[]) throws FileNotFoundException{
    
        Scanner scanner = new Scanner (System.in);
        KeyPair clave;
        int Ksize = 512;
        PrivateKey clauPrivada;
        PublicKey clauPublica;
    
        //Generem el parell de claus
        clave = randomGenerate (Ksize);
        
        
        //Agafem la clau privada i publica generada
        clauPrivada = clave.getPrivate(); 
        clauPublica = clave.getPublic();

        //Guardem la clau publica i la privada en dos arxius
        File publicKey = new File ("clauPublica.txt");
        PrintStream writerPublic = new PrintStream (publicKey);        
        writerPublic.println(clauPublica);
        writerPublic.close();
              
        File privateKey = new File ("clauPrivada.txt");    
        PrintStream writerPrivate = new PrintStream (privateKey);  
        writerPrivate.println(clauPrivada);
        writerPrivate.close();    
    }
    
    public static KeyPair randomGenerate(int longuitudClau) {
            KeyPair keys = null;
            try {
                KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
                keyGen.initialize(longuitudClau);
                keys = keyGen.genKeyPair();
            } catch (Exception ex) {
                System.err.println("Generador no disponible.");
            }
        return keys;
        }
    
}
